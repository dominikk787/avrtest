const unsigned char PROGMEM font[CHAR_COUNT8][FONT_WIDTH]=
{
{0x08,0x3E,0x22,0x22,0x3E,0x08},	/*(01) 0x00 Resistor3  */                    
{0x08,0x7F,0x22,0x14,0x08,0x7F},	/*     0x01 Diode1  */                       
{0x7F,0x08,0x14,0x22,0x7F,0x08},	/*     0x02 Diode2  */                       
{0x7F,0x7F,0x00,0x00,0x7F,0x7F},	/*     0x03 Capacitor  */                    
{0x00,0x58,0x64,0x04,0x64,0x58},	/*     0x04 Omega  */                        
{0x00,0x80,0x7C,0x40,0x40,0x3C},	/*     0x05 mu (Âµ) */                        
{0x22,0x22,0x22,0x22,0x22,0x3E},	/*     0x06 Resistor1  */                    
{0x3E,0x22,0x22,0x22,0x22,0x22},	/*     0x07 Resistor2  */                    
{0x08,0x08,0x08,0x08,0x08,0x08},	/*     0x08 Line1 */                         
{0x38,0x40,0x40,0x30,0x40,0x40},	/*(10) 0x09 Inductor1 */                     
{0x30,0x40,0x40,0x30,0x40,0x38},	/*     0x0a Inductor2 */                     
{0x00,0x80,0x7E,0x01,0x49,0x36},	/*     0x0b Beta */                          
{0x00,0x06,0x29,0x79,0x29,0x06},	/*     0x0c  */                              
{0x00,0x00,0x00,0x00,0x00,0x00},	/*     0x0d  */                              
{0x00,0x60,0x7E,0x0A,0x35,0x3F},	/*     0x0e  */                              
{0x00,0x2A,0x1C,0x36,0x1C,0x2A},	/*     0x0f  */                              
{0x00,0xE0,0x51,0x4F,0x41,0xFF},	/*    (0xe0 - GR_OFFSET2),Cyr_D       */    
{0x00,0x7F,0x40,0x40,0x40,0xFF},	/*    (0xe1 - GR_OFFSET2),Cyr_C       */    
{0x00,0x7F,0x40,0x7F,0x40,0xFF},	/*    (0xe2 - GR_OFFSET2),Cyr_Schtsch */    
{0x00,0xE0,0x54,0x4C,0x44,0xFC},	/*(20)(0xe3 - GR_OFFSET2),Cyr_d       */    
{0x00,0x18,0x24,0x7E,0x24,0x18},	/*    (0xe4 - GR_OFFSET2),Cyr_f       */    
{0x00,0x7C,0x40,0x40,0x40,0xFC},	/*    (0xe5 - GR_OFFSET2),Cyr_c       */    
{0x00,0x7C,0x40,0x7C,0x40,0xFC},	/*    (0xe6 - GR_OFFSET2),Cyr_schtsch */    
{0x00,0x14,0xB6,0xFF,0xB6,0x14},	/*     0x17  */                              
{0x00,0x04,0x06,0x7F,0x06,0x04},	/*     0x18  */                              
{0x00,0x10,0x30,0x7F,0x30,0x10},	/*     0x19  */                              
{0x00,0x08,0x08,0x3E,0x1C,0x08},	/*     0x1a  */                              
{0x00,0x08,0x1C,0x3E,0x08,0x08},	/*     0x1b  */                              
{0x00,0x78,0x40,0x40,0x40,0x40},	/*     0x1c  */                              
{0x00,0x08,0x3E,0x08,0x3E,0x08},	/*(30) 0x1d  */                              
{0x00,0x30,0x3C,0x3F,0x3C,0x30},	/*     0x1e  */                              
{0x00,0x03,0x0F,0x3F,0x0F,0x03},	/*(32) 0x1f  */                        
{0x00,0x00,0x00,0x00,0x00,0x00},	/*(001)0x20 ' ' */                           
{0x00, 0x00, 0x00, 0x5E, 0x00, 0x00},	/*     0x21 '!' */                           
{0x00, 0x00, 0x06, 0x00, 0x06, 0x00},	/*     0x22 '"' */                           
{0x00, 0x28, 0x7C, 0x28, 0x7C, 0x28},	/*     0x23 '#' */                           
{0x00, 0x48, 0x54, 0xD6, 0x54, 0x24},	/*     0x24 '$' */                           
{0x00, 0x42, 0x20, 0x18, 0x04, 0x42},	/*     0x25 '%' */                           
{0x00, 0x34, 0x4A, 0x5A, 0x24, 0x50},	/*     0x26 '&' */                           
{0x00, 0x00, 0x0A, 0x06, 0x00, 0x00},	/*     0x27 ''' */                           
{0x00, 0x00, 0x18, 0x24, 0x42, 0x00},	/*     0x28 '(' */                           
{0x00, 0x00, 0x42, 0x24, 0x18, 0x00},	/*(010)0x29 ')' */                           
{0x00,0x14,0x08,0x3E,0x08,0x14},	/*     0x2a '*' */                           
{0x00, 0x10, 0x38, 0x10, 0x00, 0x00},	/*     0x2b '+' */                           
{0x00,0x00,0xA0,0x60,0x00,0x00},	/*     0x2c ',' */                           
{0x00, 0x10, 0x10, 0x10, 0x10, 0x00},	/*     0x2d '-' */                           
{0x00, 0x00, 0x00, 0x40, 0x00, 0x00},	/*     0x2e '.' */                           
{0x00, 0x00, 0x60, 0x18, 0x06, 0x00},	/*     0x2f '/' */                           
{0x00,0x3C,0x46,0x4A,0x52,0x3C},	/*     0x30 '0' ***************/                           
{0x00,0x00,0x44,0x7E,0x40,0x00},	/*     0x31 '1' ***************/                           
{0x00,0x64,0x52,0x52,0x52,0x4C},	/*     0x32 '2' ***************/                           
{0x00,0x24,0x42,0x4A,0x4A,0x34},	/*(020)0x33 '3' ***************/                           
{0x00,0x18,0x14,0x52,0x7E,0x50},	/*     0x34 '4' ***************/                           
{0x00,0x2E,0x4A,0x4A,0x4A,0x32},	/*     0x35 '5' ***************/                           
{0x00,0x3C,0x4A,0x4A,0x4A,0x32},	/*     0x36 '6' ***************/                           
{0x00,0x02,0x02,0x62,0x12,0x0E},	/*     0x37 '7' ***************/                           
{0x00,0x34,0x4A,0x4A,0x4A,0x34},	/*     0x38 '8' ***************/                           
{0x00,0x4C,0x52,0x52,0x52,0x3C},	/*     0x39 '9' ***************/                           
{0x00, 0x00, 0x00, 0x24, 0x00, 0x00},	/*     0x3a ':' */                           
{0x00, 0x00, 0x40, 0x24, 0x00, 0x00},	/*     0x3b ';' */                           
{0x00, 0x10, 0x28, 0x44, 0x00, 0x00},	/*     0x3c '<' */                           
{0x00, 0x00, 0x28, 0x28, 0x28, 0x00},	/*(030)0x3d '=' ***************/                           
{0x00, 0x00, 0x44, 0x28, 0x10, 0x00},	/*     0x3e '>' */                           
{0x00, 0x04, 0x02, 0x52, 0x0C, 0x00},	/*     0x3f '?' */                           
{0x00, 0x7C, 0x82, 0xBA, 0xA6, 0x5C},	/*     0x40 '@' */                           
{0x00,0x7C, 0x12, 0x12, 0x12, 0x7C},	/*     0x41 'A' */                           
{0x00,0x7E, 0x4A, 0x4A, 0x4A, 0x3C},	/* 	   0x42 'B' */                           
{0x00,0x3C,0x42,0x42,0x42,0x24},	/*	   0x43 'C' ***************/                           
{0x00,0x7E,0x42,0x42,0x42,0x3C},	/*     0x44 'D' ***************/                           
{0x00,0x7E,0x4A,0x4A,0x4A,0x42},	/*     0x45 'E' ***************/                           
{0x00,0x7E,0x0A,0x0A,0x0A,0x02},	/*     0x46 'F' ***************/                           
{0x00,0x3C, 0x42, 0x4A, 0x4A, 0x3A},	/*(040)0x47 'G' */                           
{0x00,0x7E, 0x08, 0x08, 0x08, 0x7E},	/*     0x48 'H' */                           
{0x00,0x00, 0x42, 0x7E, 0x42, 0x00},	/*     0x49 'I' */                           
{0x00,0x22, 0x42, 0x42, 0x42, 0x3E},	/*     0x4a 'J' */                           
{0x00,0x7E, 0x08, 0x18, 0x24, 0x42},	/*     0x4b 'K' */                           
{0x00,0x7E, 0x40, 0x40, 0x40, 0x40},	/*     0x4c 'L' */                           
{0x00,0x7E, 0x04, 0x08, 0x04, 0x7E},	/*     0x4d 'M' */                           
{0x00,0x7E, 0x04, 0x08, 0x10, 0x7E},	/*     0x4e 'N' */                           
{0x00,0x3C, 0x42, 0x42, 0x42, 0x3C},	/*     0x4f 'O' */                           
{0x00,0x7E, 0x12, 0x12, 0x12, 0x0C},	/*     0x50 'P' */                           
{0x00,0x3C, 0x42, 0x52, 0x22, 0x5C},	/*(050)0x51 'Q' */                           
{0x00,0x7E,0x12,0x12,0x32,0x4C},	/*     0x52 'R' ************/                           
{0x00,0x24,0x4A,0x4A,0x52,0x24},	/*     0x53 'S' ************/                           
{0x00,0x02,0x02,0x7E,0x02,0x02},	/*     0x54 'T' ************/                           
{0x00,0x3E,0x40,0x40,0x40,0x3E},	/*     0x55 'U' ************/                           
{0x00,0x1E,0x20,0x40,0x20,0x1E},	/*     0x56 'V' ************/                           
{0x00,0x3E,0x40,0x3C,0x40,0x3E},	/*     0x57 'W' ************/                           
{0x00,0x42,0x24,0x18,0x24,0x42},	/*     0x58 'X' ************/                           
{0x00,0x02, 0x4C, 0x70, 0x4C, 0x02},	/*     0x59 'Y' ************/                           
{0x00,0x66, 0x52, 0x4A, 0x46, 0x62},	/*     0x5a 'Z' ************/                           
{0x00,0x00, 0x00, 0x7E, 0x42, 0x00},	/*(060)0x5b '[' */                           
{0x00,0x00, 0x06, 0x18, 0x60, 0x00},	/*     0x5c '\' */                           
{0x00,0x00, 0x00, 0x42, 0x7E, 0x00},	/*     0x5d ']' */                           
{0x00,0x00, 0x04, 0x02, 0x04, 0x00},	/*     0x5e '^' */                           
{0x00, 0x40, 0x40, 0x40, 0x40, 0x40},	/*     0x5f '_' */                           
{0x00,0x00, 0x02, 0x04, 0x00, 0x00},	/*     0x60 '`' */                           
{0x00,0x20,0x54,0x54,0x54,0x38},	/*     0x61 'a' */                           
{0x00, 0x7E, 0x44, 0x44, 0x44, 0x38},	/*     0x62 'b' */                           
{0x00, 0x38, 0x44, 0x44, 0x44, 0x28},	/*     0x63 'c' */                           
{0x00, 0x38, 0x44, 0x44, 0x44, 0x7E},	/*     0x64 'd' */                           
{0x00,0x38,0x54,0x54,0x54,0x18},	/*(070)0x65 'e' */                           
{0x00, 0x08, 0x7C, 0x0A, 0x0A, 0x00},	/*     0x66 'f' */                           
{0x00, 0x98, 0xA4, 0xA4, 0x94, 0x7C},	/*     0x67 'g' */                           
{0x00, 0x7E, 0x08, 0x08, 0x08, 0x70},	/*     0x68 'h' */                           
{0x00,0x00, 0x48, 0x7A, 0x40, 0x00},	/*     0x69 'i' */                           
{0x00,0x40, 0x80, 0x88, 0x7A, 0x00},	/*     0x6a 'j' */                           
{0x00,0x7E, 0x10, 0x68, 0x44, 0x00},	/*     0x6b 'k' */                           
{0x00,0x00, 0x42, 0x7E, 0x40, 0x00},	/*     0x6c 'l' */                           
{0x00, 0x78, 0x04, 0x78, 0x04, 0x78},	/*     0x6d 'm' */                           
{0x00, 0x78, 0x04, 0x04, 0x7C, 0x00},	/*     0x6e 'n' */                           
{0x00, 0x38, 0x44, 0x44, 0x44, 0x38},	/*(080)0x6f 'o' */                           
{0x00, 0xFC, 0x24, 0x44, 0x44, 0x38},	/* 0x70 'p' */                           
{0x00, 0x38, 0x44, 0x44, 0x24, 0xFC},	/* 0x71 'q' */                           
{0x00, 0x00, 0x78, 0x04, 0x04, 0x08},	/* 0x72 'r' */                           
{0x00,0x48,0x54,0x54,0x54,0x20},	/* 0x73 's' */                           
{0x00, 0x04, 0x3E, 0x44, 0x24, 0x00},	/* 0x74 't' */                           
{0x00,0x3C,0x40,0x40,0x20,0x7C},	/* 0x75 'u' */                           
{0x00,0x1C,0x20,0x40,0x20,0x1C},	/* 0x76 'v' */                           
{0x00,0x3C,0x40,0x30,0x40,0x3C},	/* 0x77 'w' */                           
{0x00,0x44,0x28,0x10,0x28,0x44},	/* 0x78 'x' */                           
{0x00, 0x8C, 0x90, 0x60, 0x10, 0x0C},	/* 0x79 'y' */                           
{0x00,0x44,0x64,0x54,0x4C,0x44},	/* 0x7a 'z' */                           
{0x00,0x00,0x08,0x36,0x41,0x00},	/* 0x7b '{' */                           
{0x00, 0x00, 0x00, 0xFE, 0x00, 0x00},	/* 0x7c '|' */                           
{0x00,0x00,0x41,0x36,0x08,0x00},	/* 0x7d '}' */                           
{0x00,0x08,0x08,0x2A,0x1C,0x08},	/* 0x7e '~' */                           
{0x00,0x3C,0x26,0x23,0x26,0x3C},	/* 0x7f  */                                                                                                                                     
};

#define CMD_CLEAR	0x01		/* clear display, basic Instruction */
#define CMD_CGRAM_SELECT 0x02		/* SR=0, enable CGRAM address */
#define CMD_SET_ENTRY_MODE 0x04		/* set cursor posistion and shift for read/write */
#define MODE_RIGHT_MOVE 0x02
#define CMD_DISPLAY_CONTROL	0x08	/* display control, basic Instruction */
#define DISPLAY_ON 0x4
#define CURSOR_ON 0x02
#define BLINK_ON 0x01
#define CMD_DISPLAY_ON	(CMD_DISPLAY_CONTROL | DISPLAY_ON)
#define CMD_DISPLAY_OFF	CMD_DISPLAY_CONTROL
#define CMD_SET_FUNCTION 0x20		/* basic + extended Instruction */
#define MODE_8_BIT 0x10		/* Bit 4 is 8 bit mode */
#define MODE_EXTENDED 0x04		/* Bit 2 is used for extended Intruction */
#define GRAPHIC_DISPLAY_ON 0x02	/* Bit 1 is used for graphic display on, only extended Instruction */
#define CMD_SET_GDRAM_ADDRESS 0x80	/* set graphic display RAM address ,extended Instruction */

uint8_t lcd_bit_mem[SCREEN_HEIGHT][SCREEN_WIDTH / 8];

void lcd_set_pixels(const unsigned char *pdata, unsigned char x, unsigned char y,
	unsigned char width, unsigned char height) {
	unsigned char ii,hh,hmsk;
	unsigned char jj;
	unsigned char xx,xxbit;
	unsigned char ymem;
	if (((x+width) > 128) || ((y+height) > 64)) return;
	for (ii=0; ii<height; ii++) {
		hh = ii / 8;
		hmsk = pgm_read_byte(set_msk + (ii % 8));
		for (jj=0; jj<width; jj++) {
			xx = (x + jj) / 8;
			xxbit = (x + jj) % 8;
			ymem = y + ii;
			if ((pgm_read_byte(pdata + jj + (hh*width)) & hmsk) == 0) {
				// clear bit in the pixel image
				lcd_bit_mem[ymem][xx] &= pgm_read_byte(clear_msk+(7-xxbit));
			} else {
				// set bit in the pixel image
				lcd_bit_mem[ymem][xx] |= pgm_read_byte(set_msk+(7-xxbit));
			}
		} /* end for jj */
	} /* end for ii */
}

void lcd_data(unsigned char temp1) {
/* -------------------------------------------------------------------------- */
	_lcd_column++;
	 uint8_t *pfont;
	 pfont = (uint8_t *)font + (FONT_WIDTH * temp1);	// first byte of character data
	 // for other controllers like ST7565 the _page specifies the page of the controller (8 lines)
	 lcd_set_pixels( pfont, _xpos, _page*8, (unsigned char)FONT_WIDTH, (unsigned char)8);
	_xpos += FONT_WIDTH;		// move pointer to the next character position
} /* end lcd_data() */

void lcd_refresh(void) {
	unsigned char xx;
	unsigned char yy, yyo;
	for (yy=0; yy<64; yy++) {
		yyo = (yy + LCD_ST7565_Y_START) & 0x3f;	/* the y-address with offset */
		if (yyo < 32) {
			lcd_command(CMD_SET_GDRAM_ADDRESS|yyo);	/* set vertical start address */
			lcd_command(CMD_SET_GDRAM_ADDRESS|0);	/* horizontal address starts with 0 */
		} else {
			// the second half of display is located at GDRAM address 128..255 ((8..15) x 16 pixel)
			lcd_command(CMD_SET_GDRAM_ADDRESS|(yyo-32));	/* set vertical start address */
			lcd_command(CMD_SET_GDRAM_ADDRESS|(SCREEN_WIDTH / 16));	/* horizontal address starts with 0 (128)*/
		}
		for (xx=0; xx<(128 / 8); xx++) {
			lcd_write_data(lcd_bit_mem[yy][xx]);	// write 16 x 8 bits to GDRAM (= 128 pixel)
		}
	} /* end for yy */
}